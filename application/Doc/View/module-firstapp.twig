{% extends 'base.twig' %}

{% block title %}Создание первого приложения{% endblock %}

{% block content %}
    <h3>Создание первого приложения</h3>
    <p>На данном этапе мы еще не сталкивались с работой контроллеров, поэтому наше приложение будет предельно простым.
    </p>
    <h4>Создание и регистрация модуля</h4>
    <p>На предыдущих страницах мы рассматривали примеры создания модулей, поэтому описание этого процесса мы опустим.</p>
    <p>Для начала создадим папку <code>Hello</code> в папке <code>application</code> фреймворка. Данная папка и будет
        нашим первым модулем. Теперь зарегистрируем наш модуль в файле <code>framework/config/bootstrap.php</code>,
    как описано на предыдущих страницах.</p>
    <h4>Создание контроллера</h4>
    <p>Настало время создать наш первый контроллер. Для этого создаем папку <code>Controller</code>, в папке нашего
        модуля (структура должна выглядеть так <code>application/Hello/Controller</code>). Далее создаем файл Base.php,
    который будет содержать наш контроллер и запишем в него следующее:</p>
    <p>
    <pre class="php" style="font-family:monospace;"><ol><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000000; font-weight: bold;">&lt;?php</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// Пространство имен нашего контроллера</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// App - корень пространства имен, зарегистрированный на папку application в файле framework/config/autoload.php</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// Hello - Имя модуля</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #000000; font-weight: bold;">namespace</span> App\Hello\Controller<span style="color: #339933;">;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// Импортирование класса для базового контроллера</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    use DMF\Core\Controller\Controller<span style="color: #339933;">;</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// Создание класса контроллера и наследование его от базового класса</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #000000; font-weight: bold;">class</span> Base <span style="color: #000000; font-weight: bold;">extends</span> Controller</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #009900;">&#123;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #666666; font-style: italic;">// Данный метод является действием и возвращает нужные данные</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> index<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #009900;">&#123;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #b1b100;">return</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">string</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Hello, World!'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #009900;">&#125;</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #009900;">&#125;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li></ol></pre>
    </p>
    <p>Ссылка на <a href="http://pastebin.com/eRPTjxqe">pastebin</a></p>
    <p>Каждый контроллер должен быть унаследован от класса <code>DMF\Core\Controller\Controller</code> или от дочернего
    к нему. Методы контроллера могут как являться действиями, так и использоваться для промежуточных расчетов. Жесткой
    привязки фреймворк не задает - вы сами решаете, что именно будет делать тот или иной метод. Единственное условия:
    действие должно являтся публичным методом, в противном случае его вызов будет сопровождаться ошибкой.</p>
    <h4>Создание маршрута</h4>
    <p>У нас уже имеется модуль и контроллер в нем. Фреймворку известно о модуле, но неизвестно когда его загружать
    и какие методы контроллера использовать. Нам необходимо сообщить ему об этом с помощью создания маршрута.
    Для определения маршрутов используется файл <code>framework/config/routes.php</code>. Маршруты представляют из
    себя регулярное выражение. Регистрация маршрутов производится посредством передачи методу <code>Router::routes()</code>
    массива, содержащего список маршрутов. Ключ массива является регулярным выражением. Кроме того он должен начинаться
    и завершаться символом <code>/</code>. Значение массива представляет из себя строку, состоящую из имени модуля,
    имени контроллера и имени действия, разделенные с помощью точки. Создадим для нашего тестового приложения следующий
    элемент: <code>'/hello/' => 'Hello.Base.index',</code></p>
    <p>Теперь при переходе по ссылке http://ваш_хост/hello/ будет открыта тестовая страничка с простым приветствием.
    Подробнее о создании более сложных приложений будет описано на следующих страницах.</p>

    <ul class="pager">
        <li class="previous"><a href="{{ base_url }}/doc/module-create.html">&larr; Создание модуля</a></li>
        <li class="next"><a href="{{ base_url }}/doc/controller-index.html">Описание контроллеров &rarr;</a></li>
    </ul>
{% endblock %}